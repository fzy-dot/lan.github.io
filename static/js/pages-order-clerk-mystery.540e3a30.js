(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-order-clerk-mystery"],{"1e20":function(t,e,i){"use strict";i.r(e);var a=i("ed3f"),r=i.n(a);for(var o in a)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(o);e["default"]=r.a},2279:function(t,e,i){var a=i("2e09");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var r=i("4f06").default;r("1edd8fd2",a,!0,{sourceMap:!1,shadowMode:!1})},"2e09":function(t,e,i){e=t.exports=i("24fb")(!1),e.push([t.i,'@charset "UTF-8";.text-center[data-v-1de72842]{text-align:center}.font-weight[data-v-1de72842]{font-weight:700}.page-width[data-v-1de72842]{width:100%}.goods-hover-class[data-v-1de72842]{opacity:.9;background-color:#f7f7f7}.background-image[data-v-1de72842]{background-repeat:no-repeat;background-size:100% 100%;background-position:50%}\n/*全局文字大小*/\n/* 屏幕宽度*/uni-page-body[data-v-1de72842]{font-size:%?32?%;background:#f7f7f7}.page-width[data-v-1de72842]{width:100%}.u-hover-class[data-v-1de72842]{opacity:.9;background-color:#f7f7f7}.safe-area-inset-bottom[data-v-1de72842]{padding-bottom:0;padding-bottom:constant(safe-area-inset-bottom);padding-bottom:env(safe-area-inset-bottom)}.mystery ._search_head[data-v-1de72842]{position:fixed;top:0;left:0;width:100vw;background:#f6f6f6;z-index:1}.mystery ._search_head ._search-goods[data-v-1de72842]{height:%?86?%;background:#fff;margin:%?8?% %?24?%;padding:0 %?32?%;border-radius:%?35?%}.mystery ._search_hide[data-v-1de72842]{height:%?102?%;width:100%}.mystery ._s_project[data-v-1de72842]{margin:%?10?% %?24?%}.mystery ._s_project .goods-pic[data-v-1de72842]{height:%?210?%;width:%?210?%;display:block}.mystery ._s_project .right-box[data-v-1de72842]{height:%?210?%;background:#fff;border-radius:%?16?%;overflow:hidden}.mystery ._s_project .right-box ._s-goods[data-v-1de72842]{padding:%?16?% %?20?%}.mystery ._s_project .left-icon[data-v-1de72842]{height:%?40?%;width:%?40?%;display:block;margin-right:%?30?%;border-radius:50%}.bg[data-v-1de72842]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.3);z-index:1000}.bg .dialog[data-v-1de72842]{margin-top:%?-100?%;width:%?630?%;background-color:#fff;padding-top:%?40?%;border-radius:%?16?%;font-size:%?32?%;color:#353535;text-align:center}.bg .dialog .dialog-content[data-v-1de72842]{margin:%?40?%}.bg .dialog .dialog-btn[data-v-1de72842]{color:#ff4544;height:%?88?%;line-height:%?88?%;border-top:%?1?% solid #e2e2e2}.bg .remark-dialog[data-v-1de72842]{margin-top:%?-100?%;padding-top:%?32?%;background-color:#fff;border-radius:%?16?%;font-size:%?32?%;color:#353535}.bg .remark-dialog .title[data-v-1de72842]{text-align:center;font-size:%?32?%;margin-top:%?8?%;margin-bottom:%?32?%}.bg .remark-dialog .textarea[data-v-1de72842]{width:%?556?%;height:%?300?%;border:%?1?% solid #e2e2e2;border-radius:%?16?%;padding:%?24?% %?32?%;margin:0 %?32?%}.bg .remark-dialog .bottom-box[data-v-1de72842]{height:%?88?%;border-top:%?1?% solid #e2e2e2;margin-top:%?32?%;padding:%?20?% 0}.bg .remark-dialog .bottom-box .cancel-text[data-v-1de72842]{font-size:%?34?%;color:#666;width:0}.bg .remark-dialog .bottom-box .clerk-text[data-v-1de72842]{font-size:%?34?%;color:#ff4544;width:0;border-left:%?1?% solid #e2e2e2}.action-box[data-v-1de72842]{position:fixed;background-color:#fff;height:%?112?%;padding:%?22?% %?24?%;bottom:0;width:100%;z-index:999}.action-box .btn[data-v-1de72842]{background-color:#ff4544;color:#fff;z-index:999;width:100%;font-size:%?32?%;height:%?68?%;line-height:%?68?%;border-radius:%?44?%}.action-box .no-clerk-permission[data-v-1de72842]{background-color:#b2b2b2}.action-box .btn[data-v-1de72842]::after{border:0}.action-box .clerk-text[data-v-1de72842]{font-size:%?36?%;height:100%;color:#666}.action-box .left-box[data-v-1de72842]{margin-right:%?20?%}.action-box .left-box .edit-icon[data-v-1de72842]{width:%?20?%;height:%?20?%;margin-bottom:%?10?%}.action-box .left-box .edit-remark[data-v-1de72842]{font-size:%?28?%;color:#999}.dialog[data-v-1de72842]{width:%?630?%;background-color:#fff;padding-top:%?40?%;border-radius:%?16?%;font-size:%?32?%;color:#353535;text-align:center}.dialog-content[data-v-1de72842]{margin:%?40?%}.dialog-btn[data-v-1de72842]{color:#ff4544;height:%?88?%;line-height:%?88?%;border-top:%?1?% solid #e2e2e2}.dialog-btn .view1[data-v-1de72842]{color:#353535;width:50%}.dialog-btn .view2[data-v-1de72842]{height:%?45?%;width:%?1?%;background-color:#e2e2e2}.dialog-btn .view3[data-v-1de72842]{width:50%}body.?%PAGE?%[data-v-1de72842]{background:#f7f7f7}',""])},"47ce":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAMAAAAM7l6QAAAAclBMVEUAAACZmZmampqZmZmZmZmZmZmZmZmWlpaXl5eZmZmZmZmZmZmampqampqZmZmZmZmZmZmZmZmampqZmZmZmZmampqampqampqZmZmYmJiampqmpqaZmZmZmZmZmZmZmZmZmZmZmZmYmJiZmZmbm5uZmZmijWVKAAAAJXRSTlMA/HD21+NWFgaf8eyxLx7etKSUjn14YUo4KiQKz8zLvIVnXE5AZsErYAAAAQxJREFUKM+FktmSgyAUBUHE4L4kLtnX/v9fnCJRmSg10y+nqOYeClRMFEFWKplemt6IFUUsmdDd0gYKVLXromAbAqfDb2liSIPjuMozSF/CEUO2EY4+QeWuGRrxxUGjp/2FIhMLBkU8V6eu2TXK/DMsCcQKU1KP+9RRrGlJjM2MSnjYw2CzZCd8JNxtKDqvDj9jksirz9xspARerWltXNj67HFsbQh9+gmFzR5yj67HKaPJPNee37KDfqWv6OmfOpEcFnYLj/nrpuhhaWO3eilUYNy5VyDcOJ9rKNv9+77PWkIlv/wmlkASnrVN/RDR2zvyOuFDaM9ZeWGG++7WRu+3cn6N85X4y6tG/MMP6FcWRzmrrdsAAAAASUVORK5CYII="},5263:function(t,e,i){"use strict";var a=i("2279"),r=i.n(a);r.a},6217:function(t,e,i){"use strict";i.r(e);var a=i("7ef1"),r=i("1e20");for(var o in r)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return r[t]}))}(o);i("5263");var n,d=i("f0c5"),s=Object(d["a"])(r["default"],a["b"],a["c"],!1,null,"1de72842",null,!1,a["a"],n);e["default"]=s.exports},"7ef1":function(t,e,i){"use strict";var a;i.d(e,"b",(function(){return r})),i.d(e,"c",(function(){return o})),i.d(e,"a",(function(){return a}));var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("app-layout",[a("v-uni-view",[t.orderDetail?a("v-uni-view",{staticClass:"mystery"},[a("v-uni-view",{staticClass:"_search_head"},[t.toSearch?a("v-uni-input",{staticClass:"_search-goods",attrs:{value:t.keyword,"confirm-type":"search",focus:t.getFocus},on:{input:function(e){arguments[0]=e=t.$handleEvent(e),t.bindInput.apply(void 0,arguments)},confirm:function(e){arguments[0]=e=t.$handleEvent(e),t.bindConfirm.apply(void 0,arguments)},blur:function(e){arguments[0]=e=t.$handleEvent(e),t.beSearch.apply(void 0,arguments)}}}):a("v-uni-view",{staticClass:"_search-goods cross-center",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.beSearch.apply(void 0,arguments)}}},[a("v-uni-image",{staticStyle:{height:"26rpx",width:"26rpx"},attrs:{src:i("47ce")}}),a("v-uni-view",{staticStyle:{"margin-left":"14rpx",color:"#999999"}},[t._v("输入商品名称搜索")])],1)],1),a("v-uni-view",{staticClass:"_search_hide"}),a("v-uni-view",[t.mystery_list&&t.mystery_list.length?t._l(t.mystery_list,(function(e,i){return a("v-uni-view",{key:i,staticClass:"_s_project dir-left-nowrap cross-center main-between"},[t.mystery_index_id===e.id?a("v-uni-image",{staticClass:"box-grow-0 left-icon",attrs:{src:"/static/image/icon/icon-checkbox-checked-a.png"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.mystery_index_id=e.id}}}):a("v-uni-image",{staticClass:"box-grow-0 left-icon",attrs:{src:"/static/image/icon/form-er.png"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.mystery_index_id=e.id}}}),a("v-uni-view",{staticClass:"dir-left-nowrap right-box box-grow-1",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.mystery_index_id=e.id}}},[a("v-uni-image",{staticClass:"goods-pic box-grow-0",attrs:{src:e.cover_pic}}),a("v-uni-view",{staticClass:"dir-top-nowrap box-grow-1 _s-goods"},[a("v-uni-view",{staticClass:"box-grow-0 t-omit-two",staticStyle:{"font-size":"28rpx",color:"#333333"}},[t._v(t._s(e.goods_name))]),t._l(e.attr,(function(i,r){return e.goods_attr_id===i.id?a("v-uni-view",{key:r,staticClass:"box-grow-1 t-omit-two",staticStyle:{"font-size":"24rpx",color:"#999999","margin-top":"6rpx"}},[t._v(t._s(i.attr_str))]):t._e()})),a("v-uni-view",{staticClass:"box-grow-0 dir-left-nowrap cross-center main-between",staticStyle:{"margin-top":"auto","font-size":"24rpx"}},[a("v-uni-view",{staticStyle:{color:"#999999"}},[t._v("x1")]),a("v-uni-view",{staticStyle:{color:"#333333"}},[t._v("¥"+t._s(e.price))])],1)],2)],1)],1)})):a("v-uni-view",{staticClass:"ttt dir-top-nowrap main-center cross-center"},[a("v-uni-image",{staticStyle:{height:"240rpx",width:"240rpx","margin-top":"30%"},attrs:{src:"/static/image/no-goods.png"}}),a("v-uni-view",{staticStyle:{"font-size":"24rpx","margin-top":"24rpx",color:"666666"}},[t._v("很抱歉，没有搜到相关商品～")])],1)],2)],1):t._e(),a("v-uni-view",{staticStyle:{height:"140rpx",width:"100%"}}),t.orderDetail?a("v-uni-view",{staticClass:"action-box"},[1==t.orderDetail.is_pay&&0==t.orderDetail.clerk_id?a("v-uni-view",{staticClass:"dir-left-nowrap cross-center"},[t.orderDetail.is_clerk_permission?[a("v-uni-view",{staticClass:"dir-top-nowrap box-grow-0 cross-center left-box",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.orderClerkRemark.apply(void 0,arguments)}}},[a("v-uni-image",{staticClass:"edit-icon",attrs:{src:t.clerkImg.edit}}),a("v-uni-view",{staticClass:"edit-remark"},[t._v("备注")])],1),a("v-uni-button",{staticClass:"box-grow-1 btn",style:{backgroundColor:"rgba(255,69,68,1)"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.orderClerk.apply(void 0,arguments)}}},[t._v("核销订单")])]:[a("v-uni-button",{staticClass:"btn no-clerk-permission"},[t._v("无该门店核销权限")])]],2):a("v-uni-view",{staticClass:"cross-center main-center clerk-text"},[t._v("订单已核销")])],1):t._e()],1),t.msg?a("v-uni-view",{staticClass:"bg cross-center main-center"},[a("v-uni-view",{staticClass:"dialog"},[a("v-uni-view",[t._v("提示")]),a("v-uni-view",{staticClass:"dialog-content"},[t._v("无核销权限")]),a("v-uni-view",{staticClass:"dialog-btn",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toIndex.apply(void 0,arguments)}}},[t._v("确认")])],1)],1):t._e(),t.remarkClerk?a("v-uni-view",{staticClass:"bg cross-center main-center"},[a("v-uni-view",{staticClass:"remark-dialog"},[a("v-uni-view",{staticClass:"title"},[t._v("备注")]),a("v-uni-textarea",{staticClass:"textarea",attrs:{placeholder:"请输入核销备注"},model:{value:t.clerk_remark,callback:function(e){t.clerk_remark=e},expression:"clerk_remark"}}),a("v-uni-view",{staticClass:"dir-left-nowrap bottom-box"},[a("v-uni-view",{staticClass:"box-grow-1 cross-center main-center cancel-text",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.remarkClerk=!1}}},[t._v("取消")]),a("v-uni-view",{staticClass:"box-grow-1 cross-center main-center clerk-text",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.orderClerk.apply(void 0,arguments)}}},[t._v("核销订单")])],1)],1)],1):t._e()],1)},o=[]},ed3f:function(t,e,i){"use strict";var a=i("4ea4");i("8e6e"),i("ac6a"),i("456d"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=a(i("ade3")),o=i("2f62");function n(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,a)}return i}function d(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?n(Object(i),!0).forEach((function(e){(0,r.default)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):n(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var s={name:"mystery",data:function(){return{clerked:!1,haveForm:!0,id:null,orderDetail:null,clerk_remark:"",is_show:!1,msg:!1,remarkClerk:!1,toSearch:!1,getFocus:!1,keyword:"",mystery_index_id:0,mystery_list:[],page:1,args:!1,load:!1,is_mystery:1}},computed:d({},(0,o.mapState)({userInfo:function(t){return t.user.info},clerkImg:function(t){return t.mallConfig.__wxapp_img.clerk}})),onLoad:function(t){var e=this;this.$commonLoad.onload(t),this.id=t.id,this.searchMystery();var i=setInterval((function(){e.userInfo&&(e.IsClerk(),clearInterval(i))}),500)},onReachBottom:function(){var t=this;if(!t.args&&!t.load&&0!=t.is_mystery){t.load=!0;var e=t.page+1;t.$request({url:t.$api.mystery.goods_list,data:{page:e,order_id:this.id,search:{keyword:t.keyword}}}).then((function(i){if(0===i.code){var a=[e,0===i.data.list.length,t.mystery_list.concat(i.data.list)];t.page=a[0],t.args=a[1],t.mystery_list=a[2]}t.load=!1}))}},methods:{toIndex:function(){uni.redirectTo({url:"/pages/index/index"})},searchMystery:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.$request({url:this.$api.mystery.goods_list,data:{page:1,order_id:this.id,search:{keyword:e}}}).then((function(e){0===e.code?t.mystery_list=e.data.list:uni.showToast({title:e.data.msg,icon:"none"})}))},IsClerk:function(){var t=this;this.$showLoading(),this.$request({url:this.$api.user.is_clerk,data:{clerk_id:this.userInfo.options.user_id}}).then((function(e){0===e.code&&(1==e.data.is_clerk_user?t.getOrderDetail():(t.$hideLoading(),t.msg=!0))})).catch((function(){t.$hideLoading()}))},getOrderDetail:function(){var t=this;this.$request({url:this.$api.order.detail,data:{id:this.id,action_type:1}}).then((function(e){t.$hideLoading(),t.is_show=!0,0===e.code&&(t.orderDetail=e.data.detail)})).catch((function(){t.$hideLoading()}))},orderClerk:function(){var t=this;return t.remarkClerk&&(t.remarkClerk=!1),!t.clerked&&(t.mystery_index_id?void uni.showModal({content:"是否核销订单？",success:function(e){if(e.confirm){t.$showLoading();var i={id:t.id,action_type:1,activity_goods_id:t.mystery_index_id,plugin:t.orderDetail.sign,clerk_remark:t.clerk_remark};t.clerked=!0,t.$request({url:t.$api.order.order_clerk,data:i}).then((function(e){t.$hideLoading(),uni.showToast({title:e.msg,icon:"none",duration:1e3,success:function(){0===e.code&&setTimeout((function(){uni.redirectTo({url:"/plugins/clerk/order/order?status=1&type=1"})}),1e3)}})})).catch((function(){t.$hideLoading()}))}}}):(uni.showToast({title:"请选择商品",icon:"none",duration:1e3}),!1))},orderClerkRemark:function(){this.remarkClerk=!0},bindInput:function(t){this.keyword=t.detail.value},bindConfirm:function(t){var e=t.detail;this.searchMystery(e.value)},beSearch:function(t){this.keyword||(this.toSearch=!this.toSearch,this.getFocus=this.toSearch)}}};e.default=s}}]);