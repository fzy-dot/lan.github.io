(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-order-appraise-appraise"],{1211:function(t,e,a){var o=a("54f9");"string"===typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);var i=a("4f06").default;i("377b3e2f",o,!0,{sourceMap:!1,shadowMode:!1})},"1cee":function(t,e,a){"use strict";a.r(e);var o=a("7340"),i=a.n(o);for(var n in o)["default"].indexOf(n)<0&&function(t){a.d(e,t,(function(){return o[t]}))}(n);e["default"]=i.a},"2f74":function(t,e,a){e=t.exports=a("24fb")(!1),e.push([t.i,'@charset "UTF-8";.text-center[data-v-b983ff62]{text-align:center}.font-weight[data-v-b983ff62]{font-weight:700}.page-width[data-v-b983ff62]{width:100%}.goods-hover-class[data-v-b983ff62]{opacity:.9;background-color:#f7f7f7}.background-image[data-v-b983ff62]{background-repeat:no-repeat;background-size:100% 100%;background-position:50%}\n/*全局文字大小*/\n/* 屏幕宽度*/uni-page-body[data-v-b983ff62]{font-size:%?32?%;background:#f7f7f7}.page-width[data-v-b983ff62]{width:100%}.u-hover-class[data-v-b983ff62]{opacity:.9;background-color:#f7f7f7}.safe-area-inset-bottom[data-v-b983ff62]{padding-bottom:0;padding-bottom:constant(safe-area-inset-bottom);padding-bottom:env(safe-area-inset-bottom)}.appraise-box[data-v-b983ff62]{margin:%?24?%}.form-box .item-box[data-v-b983ff62]{border-radius:%?15?%;background-color:#fff;padding:%?24?% %?20?%;width:100%;margin-bottom:%?24?%}.form-box .goods_pic[data-v-b983ff62]{width:%?100?%;height:%?100?%}.form-box .goods_name[data-v-b983ff62]{margin-left:%?16?%;white-space:nowrap;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis}.form-box .anonymous-text[data-v-b983ff62]{font-size:%?22?%;color:#999}.form-box .grade-box[data-v-b983ff62]{margin:%?32?% %?24?%}.form-box .grade-icon[data-v-b983ff62]{width:%?68?%;height:%?68?%}.form-box .grade-item[data-v-b983ff62]{height:100%}.form-box .grade-item .title[data-v-b983ff62]{margin-top:%?12?%}.form-box .grade-item .active-title[data-v-b983ff62]{color:#ff4544}.form-box .content-box[data-v-b983ff62]{background-color:#f7f7f7;margin-top:%?20?%;padding:%?24?% %?24?% 0;border-top-left-radius:%?5?%;border-top-right-radius:%?5?%}.form-box .content[data-v-b983ff62]{height:100%;width:100%}.form-box .image-box[data-v-b983ff62]{padding:%?24?%;background-color:#f7f7f7;border-bottom-left-radius:%?5?%;border-bottom-right-radius:%?5?%}.form-box .btn[data-v-b983ff62]{background-color:#ff4544;border-radius:%?40?%;color:#fff;width:100%;margin-top:%?50?%}.form-box .check-icon[data-v-b983ff62]{width:%?28?%;height:%?28?%;margin-right:%?8?%;margin-top:%?5?%}body.?%PAGE?%[data-v-b983ff62]{background:#f7f7f7}',""])},"3c63":function(t,e,a){"use strict";var o=a("1211"),i=a.n(o);i.a},"48ed":function(t,e,a){"use strict";var o;a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return n})),a.d(e,"a",(function(){return o}));var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("app-layout",[t.is_show?a("v-uni-view",{staticClass:"appraise-box"},[a("v-uni-form",{staticClass:"form-box"},[t._l(t.appraiseData,(function(e){return a("v-uni-view",{key:e.id,staticClass:"item-box"},[a("v-uni-view",{staticClass:"dir-left-nowrap"},[a("v-uni-view",{staticClass:"box-grow-0"},[a("v-uni-image",{staticClass:"goods_pic",attrs:{mode:"aspectFill",src:e.goods_pic_url}})],1),a("v-uni-view",{staticClass:"box-grow-1 dir-left-nowrap cross-center"},[a("v-uni-text",{staticClass:"box-grow-1 goods_name t-omit-two"},[t._v(t._s(e.goods_name))]),a("v-uni-view",{staticClass:"box-grow-0",on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.checkedChange(e)}}},[e.is_anonymous?a("v-uni-image",{staticClass:"check-icon",attrs:{src:"/static/image/icon/icon-checkbox-checked-a.png"}}):a("v-uni-image",{staticClass:"check-icon",attrs:{src:"/static/image/icon/form-er.png"}})],1),a("v-uni-view",{staticClass:"anonymous-text box-grow-0",on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.checkedChange(e)}}},[t._v("匿名评价")])],1)],1),a("v-uni-view",{staticClass:"dir-left-nowrap grade-box"},t._l(e.grade,(function(o,i){return a("v-uni-view",{key:o.id,staticClass:"dir-top-nowrap box-grow-1 cross-center main-center grade-item",on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.grade(o,e,i)}}},[a("v-uni-image",{staticClass:"grade-icon",attrs:{src:o.active?o.active_icon:o.icon}}),a("v-uni-text",{staticClass:"title",class:{"active-title":!!o.active},style:{color:o.active?o.text_color:""}},[t._v(t._s(o.title))])],1)})),1),a("v-uni-view",{staticClass:"content-box"},[a("v-uni-view",{staticClass:"box-grow-1"},[a("v-uni-textarea",{staticClass:"content",attrs:{placeholder:"请输入评价内容","auto-height":!0},model:{value:e.content,callback:function(a){t.$set(e,"content",a)},expression:"item.content"}})],1)],1),a("v-uni-view",{staticClass:"image-box"},[a("app-upload-image",{attrs:{sign:e.id,count:6,maxNum:t.maxNum},on:{imageEvent:function(e){arguments[0]=e=t.$handleEvent(e),t.imageEvent.apply(void 0,arguments)}}})],1)],1)})),t.appraiseData.length?a("v-uni-button",{staticClass:"btn",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.formSubmit.apply(void 0,arguments)}}},[t._v("提交")]):t._e()],2)],1):t._e()],1)},n=[]},"54f9":function(t,e,a){e=t.exports=a("24fb")(!1),e.push([t.i,'@charset "UTF-8";.text-center[data-v-2998bb76]{text-align:center}.font-weight[data-v-2998bb76]{font-weight:700}.page-width[data-v-2998bb76]{width:100%}.goods-hover-class[data-v-2998bb76]{opacity:.9;background-color:#f7f7f7}.background-image[data-v-2998bb76]{background-repeat:no-repeat;background-size:100% 100%;background-position:50%}\n/*全局文字大小*/\n/* 屏幕宽度*/uni-page-body[data-v-2998bb76]{font-size:%?32?%;background:#f7f7f7}.page-width[data-v-2998bb76]{width:100%}.u-hover-class[data-v-2998bb76]{opacity:.9;background-color:#f7f7f7}.safe-area-inset-bottom[data-v-2998bb76]{padding-bottom:0;padding-bottom:constant(safe-area-inset-bottom);padding-bottom:env(safe-area-inset-bottom)}.upload-box[data-v-2998bb76]{background-color:#fff}.upload-box .title[data-v-2998bb76]{padding:%?15?% 0 %?15?% %?20?%}.upload-box .img[data-v-2998bb76]{width:%?188?%;height:%?188?%;margin:%?10?%;display:block}.upload-box .add-img[data-v-2998bb76]{width:%?188?%;height:%?188?%;border:%?1?% dotted #e2e2e2;background-color:#fff}.upload-box .add-img .text[data-v-2998bb76]{color:#999;font-size:%?22?%}.upload-box .add-img-icon[data-v-2998bb76]{width:%?56?%;height:%?56?%;margin-bottom:%?10?%}.upload-box .img-box[data-v-2998bb76]{position:relative}.upload-box .remove[data-v-2998bb76]{width:%?40?%;height:%?40?%;position:absolute;right:%?-5?%;top:%?-10?%;background:#ff4544;color:#fff;border-radius:50%;padding-bottom:%?8?%;font-size:%?24?%;z-index:968}.upload-box .add-img.other-border[data-v-2998bb76]{border:%?1?% solid #e2e2e2}body.?%PAGE?%[data-v-2998bb76]{background:#f7f7f7}',""])},7340:function(t,e,a){"use strict";var o=a("4ea4");a("8e6e"),a("456d"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("7f7f"),a("ac6a");var i=o(a("ade3")),n=a("2f62"),r=o(a("798e"));function s(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,o)}return a}function c(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?s(Object(a),!0).forEach((function(e){(0,i.default)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var d={components:{"app-upload-image":r.default},data:function(){return{id:null,maxNum:6,appraiseData:[],is_show:!1}},computed:c({},(0,n.mapState)({scoreImg:function(t){return t.mallConfig.__wxapp_img.mall}})),methods:{getOrderDetail:function(){var t=this;t.$showLoading(),t.$request({url:t.$api.order.detail,data:{id:this.id}}).then((function(e){if(t.$hideLoading(),0===e.code){var a=e.data.detail,o=[];a.detail.forEach((function(e){console.log(e),o.push({id:e.id,goods_pic_url:e.goods_info.pic_url?e.goods_info.pic_url:e.goods.goodsWarehouse.cover_pic,goods_name:e.goods?e.goods.goodsWarehouse.name:e.goods_info?e.goods_info.name:"",content:"",pic_list:[],grade:[{id:3,title:"好评",active:!0,text_color:"#ff4544",active_icon:t.scoreImg.score_3_active,icon:t.scoreImg.score_3},{id:2,title:"中评",active:!1,text_color:"#ff964a",active_icon:t.scoreImg.score_2_active,icon:t.scoreImg.score_2},{id:1,title:"差评",active:!1,text_color:"#606e78",active_icon:t.scoreImg.score_1_active,icon:t.scoreImg.score_1}],grade_level:3,is_anonymous:!1})})),console.log(o),t.appraiseData=o,t.is_show=!0}else uni.showModal({title:"",content:e.msg,showCancel:!1}),uni.navigateBack()})).catch((function(){t.$hideLoading()}))},imageEvent:function(t){var e=this,a=t.sign,o=t.imageList;e.appraiseData.forEach((function(t){if(t.id===a)return t.pic_list=o,!1})),this.appraiseData=e.appraiseData},grade:function(t,e,a){e.grade.forEach((function(t){t.active=!1})),t.active=!0,0==a&&(e.grade_level=3),1==a&&(e.grade_level=2),2==a&&(e.grade_level=1)},checkedChange:function(t){t.is_anonymous=!t.is_anonymous},formSubmit:function(){var t=this;uni.showLoading({title:"提交中"}),t.$request({url:t.$api.order.appraise,method:"post",data:{appraiseData:JSON.stringify(t.appraiseData),order_id:t.id}}).then((function(e){uni.hideLoading(),0===e.code?uni.redirectTo({url:"/pages/order/appraise-finish/index?id=".concat(t.id)}):uni.showModal({title:"",content:e.msg,showCancel:!1})})).catch((function(){uni.hideLoading()}))},inputEvent:function(t){var e=this,a=t.id,o=t.value;e.appraiseData.forEach((function(t){t.id!=a||(t.content=o)})),this.appraiseData=e.appraiseData}},onLoad:function(t){this.$commonLoad.onload(t),this.id=t.id,this.getOrderDetail()}};e.default=d},"798e":function(t,e,a){"use strict";a.r(e);var o=a("8747"),i=a("d877");for(var n in i)["default"].indexOf(n)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(n);a("3c63");var r,s=a("f0c5"),c=Object(s["a"])(i["default"],o["b"],o["c"],!1,null,"2998bb76",null,!1,o["a"],r);e["default"]=c.exports},8747:function(t,e,a){"use strict";var o;a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return n})),a.d(e,"a",(function(){return o}));var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",{staticClass:"app-upload-image"},[a("v-uni-view",{staticClass:"upload-box",style:{background:t.backgroundColor}},[a("v-uni-view",{staticClass:"flex-wrap"},[t._l(t.imageList,(function(e,o){return a("v-uni-view",{key:e.id,staticClass:"img-box"},[a("v-uni-view",{staticClass:"remove cross-center main-center",attrs:{mode:"aspectFill"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.remove(o)}}},[t._v("x")]),a("v-uni-image",{staticClass:"img",attrs:{src:e,mode:"aspectFill"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.previewImage(o)}}})],1)})),a("v-uni-view",{on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.chooseImage.apply(void 0,arguments)}}},[t.isAddImg?a("v-uni-view",{staticClass:"add-img dir-top-nowrap cross-center main-center",class:{"other-border":!!t.diy},style:{margin:t.margin+"rpx"}},[a("v-uni-image",{staticClass:"add-img-icon",attrs:{mode:"aspectFill",src:t.defaultImg}}),a("v-uni-text",{staticClass:"text"},[t._v(t._s(t.text))]),t.showNumber?a("v-uni-text",{staticClass:"text"},[t._v("(最多"+t._s(t.maxNum)+"张)")]):t._e()],1):t._e()],1)],2)],1)],1)},n=[]},ab03:function(t,e,a){var o=a("2f74");"string"===typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);var i=a("4f06").default;i("4a1b9b02",o,!0,{sourceMap:!1,shadowMode:!1})},c491:function(t,e,a){"use strict";var o=a("ab03"),i=a.n(o);i.a},cc49:function(t,e,a){"use strict";a.r(e);var o=a("48ed"),i=a("1cee");for(var n in i)["default"].indexOf(n)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(n);a("c491");var r,s=a("f0c5"),c=Object(s["a"])(i["default"],o["b"],o["c"],!1,null,"b983ff62",null,!1,o["a"],r);e["default"]=c.exports},d5ea:function(t,e,a){"use strict";var o=a("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=o(a("f854")),n=(o(a("e143")),function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Promise((function(e,a){(0,i.default)(t,"file").then((function(e){t.success({res:"",header:e})}))}))}),r=n;e.default=r},d877:function(t,e,a){"use strict";a.r(e);var o=a("ee1b"),i=a.n(o);for(var n in o)["default"].indexOf(n)<0&&function(t){a.d(e,t,(function(){return o[t]}))}(n);e["default"]=i.a},ee1b:function(t,e,a){"use strict";var o=a("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("c5f6");var i=o(a("d5ea")),n={name:"app-upload-image",props:{value:{default:null},defaultImg:{type:String,default:"/static/image/icon/icon-image.png"},maxNum:{type:[Number,String],default:3},sign:{type:String,default:""},backgroundColor:{type:String,default:"#f7f7f7"},margin:{type:String,default:"10"},diy:{type:Boolean,default:!1},showNumber:{type:Boolean,default:!0},text:{type:String,default:"上传图片"},count:{type:Number,default:9}},data:function(){return{imageList:this.value?this.value:[],isAddImg:!0}},methods:{checkMaxNum:function(){var t=!(this.imageList.length>=this.maxNum);this.isAddImg=t},remove:function(t){var e=this.imageList;e.splice(t,1);this.imageList=e,this.checkMaxNum(),this.$emit("imageEvent",{imageList:e,sign:this.sign})},chooseImage:function(){var t=this,e=t.imageList;uni.chooseImage({count:Number(t.maxNum),success:function(a){var o=function(o){if(o>=t.maxNum-e.length)return"break";var n=new Image;n.src=a.tempFilePaths[o],n.onload=function(){var e=document.createElement("canvas");e.width=n.width,e.height=n.height;var a=e.getContext("2d");a.drawImage(n,0,0,n.width,n.height);var o=n.src.substring(n.src.lastIndexOf(".")+1).toLowerCase(),r=e.toDataURL("image/"+o);(0,i.default)({url:t.$api.upload.file,maxNum:t.maxNum,success:function(e){e.res;var a=e.header;t.$request({url:t.$api.upload.file+"&name=base64",header:a,method:"post",data:{database:r}}).then((function(e){0===e.code?(t.imageList.push(e.data.url),t.checkMaxNum(),t.$emit("imageEvent",{imageList:t.imageList,sign:t.sign})):uni.showModal({title:"",content:e.msg,showCancel:!1})}))}})}};for(var n in a.tempFilePaths){var r=o(n);if("break"===r)break}},complete:function(a){t.$emit("imageEvent",{imageList:e,sign:t.sign})}})},previewImage:function(t){var e=this.imageList;uni.previewImage({current:e[t],urls:e})},createObjectURL:function(t){return window.URL?window.URL.createObjectURL(t):window.webkitURL.createObjectURL(t)}},created:function(){this.checkMaxNum()}};e.default=n},f854:function(t,e,a){"use strict";var o=a("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("a481"),a("96cf");var i=o(a("1da1")),n=a("8de3"),r=o(a("e143")),s=o(a("4360")),c=a("b1c7"),d=o(a("36e8")),u=function(){var t=(0,i.default)(regeneratorRuntime.mark((function t(e,a){var o,i,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return o={"X-App-Platform":e.header&&e.header["X-App-Platform"]?e.header["X-App-Platform"]:r.default.prototype.$platform,"X-Form-Id-List":JSON.stringify((0,n.popAll)()),"X-Requested-With":e.header&&e.header["X-Requested-With"]?e.header["X-Requested-With"]:"XMLHttpRequest","X-App-Version":r.default.prototype.$appVersion,"content-type":a?"multipart/form-data":"application/x-www-form-urlencoded"},t.next=3,s.default.dispatch("user/loadAccessTokenFormCache");case 3:return s.default.state.user&&s.default.state.user.accessToken&&(o["X-Access-Token"]=s.default.state.user.accessToken),s.default.state.user&&0!==s.default.state.user.tempParentId&&(o["X-User-Id"]=s.default.state.user.tempParentId+""),i={},e.url.replace(/([^=&]+)=([^&]*)/g,(function(t,e,a){i[decodeURIComponent(e)]=decodeURIComponent(a)})),-1!==(0,c.objectValues)(d.default.mch).indexOf(i.r)&&(u=r.default.prototype.$storage.getStorageSync("MCH2019"),o["Mch-Access-Token"]=u.token),t.abrupt("return",o);case 9:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}(),f=u;e.default=f}}]);